<div class="row">
  <div class="col-xs-12">
    <h2>Study Notebooks <span class="badge"><%= @study_files.count {|file| file.file_type == 'Notebook'} %></span> </h2>
  </div>
</div>
<div class="table-responsive">
  <table class="table table-striped table-condensed" id="notebooks-table">
    <thead>
      <tr>
        <th class="col-sm-5">Filename</th>
        <th class="col-sm-5">Description</th>
        <th class="col-sm-5">Launch Notebook</th>
      </tr>
    </thead>
    <tbody>
      <% @study_files.each do |study_file| %>
        <% if study_file.file_type == 'Notebook' %>
          <tr>
            <td><%= study_file.upload_file_name.nil? ? study_file.name : study_file.upload_file_name %></td>
            <td><%= study_file.description %></td>
            <td><div class='btn btn-sm btn-primary notebook-launch' id='<%= study_file.upload_file_name.nil? ? study_file.name : study_file.upload_file_name %>'>Launch</div></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>

<script type="text/javascript" nonce="<%= content_security_policy_script_nonce %>">
    var googleProject = "<%= @study.firecloud_project %>";
    var access_token = "Bearer <%= current_user.access_token['access_token']%>";

    // api headers
    var headers = {
        "Authorization": access_token,
        "Content-Type": "application/json"
    };

    $('#notebooks-table').DataTable({
        pagingType: 'full',
        order: [[0, 'asc']],
        autoWidth: false
    });

    $(".notebook-launch").off();
    $(".notebook-launch").click(function () {
        $('#notebookModallabel').data( "notebook", this.id);
        $('#notebookModallabel').text("Launch " + this.id);
        $('#notebookModal').modal('toggle');
    });
</script>